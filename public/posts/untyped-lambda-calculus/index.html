<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Untyped Lambda Calculus, Church Numerals, and the Y Combinator in¬†Go | Luke Hoban</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.112.7">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
<link rel="stylesheet" type="text/css" media="screen" href="/css/all.css" /><link rel="stylesheet" href="/css/katex.css" crossorigin="anonymous">
<script defer src="/js/katex.js"  integrity="sha384-PFWG8XW41D5NzhNv5FegM1CUkw9nNLdWug8DuwnUoNEVop9n5frjcnbtsZtxTNjw" crossorigin="anonymous"></script>
<script defer src="/js/auto-render.js" integrity="sha384-EN2q+JG5/3Z8gD7hT5WZqq+W+9wQR4P3IezfuZmGG5RkNXaaaks85seDJO7WkZlY" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, { delimiters: [ {left: "$$", right: "$$", display: true}, {left: "$", right: "$", display: false} ] }); });
</script>




<meta property="og:title" content="Untyped Lambda Calculus, Church Numerals, and the Y Combinator in¬†Go" />
<meta property="og:description" content="While reviewing a Go API today ‚Äî I noticed that this intriguing type is representable in the Go type system:
type V func(v V) V If you are like me ‚Äî you see that type and think ‚Äúwait, does that mean the untyped Lambda Calculus is representable inside the Go type system?‚Äù.
So let‚Äôs try&hellip;
First we need some concrete values ‚Äî but there are no base types like int or bool, only the type V ‚Äî so all we can hope for is Church encoded values." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lukehoban.com/posts/untyped-lambda-calculus/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-25T13:44:49-07:00" />
<meta property="article:modified_time" content="2020-02-25T13:44:49-07:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Untyped Lambda Calculus, Church Numerals, and the Y Combinator in¬†Go"/>
<meta name="twitter:description" content="While reviewing a Go API today ‚Äî I noticed that this intriguing type is representable in the Go type system:
type V func(v V) V If you are like me ‚Äî you see that type and think ‚Äúwait, does that mean the untyped Lambda Calculus is representable inside the Go type system?‚Äù.
So let‚Äôs try&hellip;
First we need some concrete values ‚Äî but there are no base types like int or bool, only the type V ‚Äî so all we can hope for is Church encoded values."/>

<meta itemprop="name" content="Untyped Lambda Calculus, Church Numerals, and the Y Combinator in¬†Go">
<meta itemprop="description" content="While reviewing a Go API today ‚Äî I noticed that this intriguing type is representable in the Go type system:
type V func(v V) V If you are like me ‚Äî you see that type and think ‚Äúwait, does that mean the untyped Lambda Calculus is representable inside the Go type system?‚Äù.
So let‚Äôs try&hellip;
First we need some concrete values ‚Äî but there are no base types like int or bool, only the type V ‚Äî so all we can hope for is Church encoded values."><meta itemprop="datePublished" content="2020-02-25T13:44:49-07:00" />
<meta itemprop="dateModified" content="2020-02-25T13:44:49-07:00" />
<meta itemprop="wordCount" content="692">
<meta itemprop="keywords" content="" />
</head>
<body>
<header>
<div id="titletext">
<h2 id="titleonly"><a href="https://lukehoban.com/">Luke Hoban</a></h2>
</div>
<div id="title-social">
</div>
</header>
<main>
<div class="post">
<article>
<div class="post-header">
<div class="meta">
<div class="date">
<span class="day">25</span>
<span class="rest">Feb 2020</span>
</div>
</div>
<div class="matter">
<h1 class="title">Untyped Lambda Calculus, Church Numerals, and the Y Combinator in¬†Go</h1>
<p class="post-meta">
<span class="post-meta">





</span>

</p>
</div>
</div>
<div class="markdown">
<p>While reviewing a Go API today ‚Äî I noticed that this intriguing type is representable in the Go type system:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">V</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span>
</span></span></code></pre></div><p>If you are like me ‚Äî you see that type and think ‚Äúwait, does that mean the <a href="https://en.wikipedia.org/wiki/Lambda_calculus" target="_blank">untyped Lambda Calculus</a> is representable inside the Go type system?‚Äù.</p>
<p>So let‚Äôs try&hellip;</p>
<p>First we need some concrete values ‚Äî but there are no base types like int or bool, only the type V ‚Äî so all we can hope for is <a href="https://en.wikipedia.org/wiki/Church_encoding" target="_blank">Church encoded</a> values. For booleans:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tru</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">y</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">x</span> } }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fals</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">y</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">y</span> } }
</span></span></code></pre></div><p>And for numbers:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">zero</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">x</span> } }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">one</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">x</span>) } }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">two</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">x</span>)) } }
</span></span></code></pre></div><p>That‚Äôs promising. What about some functions?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">plus</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">m</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { 
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span>(<span style="color:#a6e22e">f</span>)(<span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">f</span>)(<span style="color:#a6e22e">x</span>))
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">mult</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">m</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span>(<span style="color:#a6e22e">n</span>(<span style="color:#a6e22e">f</span>))(<span style="color:#a6e22e">x</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">isZero</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fals</span> })(<span style="color:#a6e22e">tru</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>But how do we test that these work? Go won‚Äôt let us ask whether isZero(zero) == true since both sides of the == are non-nil functions, and there is no notion of equality of functions.</p>
<p>Somehow we need to turn these functions of type V into real bool or int values. Let‚Äôs sneak some side-effects into the argument functions so we can observe what they do!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">toInt</span>() <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">n</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#a6e22e">n</span><span style="color:#f92672">++</span>; <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span> })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span> })
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">toBool</span>() <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">b</span> <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">f</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">b</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span>
</span></span><span style="display:flex;"><span>    })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">b</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span>
</span></span><span style="display:flex;"><span>    })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">v</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">v</span> })
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">b</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And what about subtraction ‚Äî that one‚Äôs a little trickier:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pred</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">g</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { 
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { 
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">h</span>(<span style="color:#a6e22e">g</span>(<span style="color:#a6e22e">f</span>))
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">u</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { 
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">x</span>
</span></span><span style="display:flex;"><span>                })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">u</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">u</span> })
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>But the real fun is that we can represent the Y combinator directly within this type ‚Äî so we can even create recursive functions!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Y</span> <span style="color:#a6e22e">V</span> = <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">x</span>))(<span style="color:#a6e22e">n</span>) } 
</span></span><span style="display:flex;"><span>    })(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">x</span>(<span style="color:#a6e22e">x</span>))(<span style="color:#a6e22e">n</span>) }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Took me a few tries to get that one right. Have to be careful to add a layer of thunks (the two ns) to the classical definition to avoid Go‚Äôs call-by-value execution leading to unbounded recursion!</p>
<p>All of that ‚Äî and finally we can write some recursive functions üéâ.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fact</span> <span style="color:#a6e22e">V</span> = <span style="color:#a6e22e">Y</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">isZero</span>(<span style="color:#a6e22e">n</span>)(
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">one</span> },
</span></span><span style="display:flex;"><span>        )(
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">x</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">mult</span>(<span style="color:#a6e22e">n</span>)(<span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">n</span>)))) },
</span></span><span style="display:flex;"><span>        )(<span style="color:#a6e22e">zero</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">fib</span> <span style="color:#a6e22e">V</span> = <span style="color:#a6e22e">Y</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">isZero</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">n</span>))(
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span> },
</span></span><span style="display:flex;"><span>        )(
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">V</span>) <span style="color:#a6e22e">V</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">plus</span>(<span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">n</span>)))(<span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">n</span>)))) },
</span></span><span style="display:flex;"><span>        )(<span style="color:#a6e22e">zero</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>Took a few tries on these to get the thunks right on those ones too (gotta make sure to not accidentally run both branches of the conditional!)</p>
<p>And it works!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Test</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">three</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">plus</span>(<span style="color:#a6e22e">two</span>)(<span style="color:#a6e22e">one</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">six</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mult</span>(<span style="color:#a6e22e">two</span>)(<span style="color:#a6e22e">three</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">sevenTwenty</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fact</span>(<span style="color:#a6e22e">six</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">eight</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fib</span>(<span style="color:#a6e22e">six</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#ae81ff">3</span>, <span style="color:#a6e22e">three</span>.<span style="color:#a6e22e">toInt</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#ae81ff">6</span>, <span style="color:#a6e22e">six</span>.<span style="color:#a6e22e">toInt</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#66d9ef">true</span>, <span style="color:#a6e22e">isZero</span>(<span style="color:#a6e22e">zero</span>).<span style="color:#a6e22e">toBool</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#66d9ef">false</span>, <span style="color:#a6e22e">isZero</span>(<span style="color:#a6e22e">one</span>).<span style="color:#a6e22e">toBool</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#ae81ff">720</span>, <span style="color:#a6e22e">sevenTwenty</span>.<span style="color:#a6e22e">toInt</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#ae81ff">2</span>, <span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">three</span>).<span style="color:#a6e22e">toInt</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#66d9ef">false</span>, <span style="color:#a6e22e">isZero</span>(<span style="color:#a6e22e">pred</span>(<span style="color:#a6e22e">two</span>)).<span style="color:#a6e22e">toBool</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">assert</span>.<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">t</span>, <span style="color:#ae81ff">8</span>, <span style="color:#a6e22e">eight</span>.<span style="color:#a6e22e">toInt</span>())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Full code:</p>
<script type="text/javascript" src="http://gist.github.com/0ec2a3dbbb9a13338d338a3fbbb039ff.js"></script>

</div>
</div>
</article>
</div>
</main><script src="/js/dark-mode.js"></script>

</body>
</html>
